
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>dlaens</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>dlaens</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 DLAENS ( DLA, end new segment )
 
      SUBROUTINE DLAENS ( HANDLE )
      IMPLICIT NONE
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     End a new segment in a DLA file.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/das.html">DAS</a>
     DLA
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     DAS
     DLA
     FILES
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
      INCLUDE 'dla.inc'     

      INTEGER               HANDLE
      
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     HANDLE     I   Handle of open DLA file.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     HANDLE      is the integer handle associated with the DLA file to
                 be updated.  This handle is used to identify the file
                 in subsequent calls to other DLA or DAS routines.

                 The DLA file must be open for write access. A new DLA
                 segment is completed in the indicated file.  The file
                 is left open, since data may be written to the file
                 following a call to this routine.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     None.  See the Particulars and Examples header sections for
     a description of the actions performed by this routine.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) If the input file handle does not refer to a DAS file that is
        open for write access, the error will be diagnosed by routines
        in the call tree of this routine.

     2) If an error occurs while reading or writing to the DLA file,
        the error will be diagnosed by routines in the call tree of
        this routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     See description of input argument HANDLE.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     DLA files are built using the DAS low-level format; DLA files are
     a specialized type of DAS file in which data are organized as a
     doubly linked list of segments.  Each segment's data belong to
     contiguous components of character, double precision, and integer
     type.

     This routine supports creation of a DLA segment.  DLA segments
     are created by appending data to the DAS integer, double 
     precision, and character address spaces of a DLA file.  The new
     segment's descriptor is located immediately before the integer
     component of the segment's data.

     When a new segment is added to a DLA file, the segment is
     inserted into the file's doubly linked segment list.  If the new
     segment is the first, the DLA file's first and last list entry
     pointers are updated to point to the new segment; specifically,
     these pointers point to the first integer of the new segment's
     descriptor.  The backward pointer of the new segment is set to
     null in this case.

     If the new segment is not the first, the DLA file's list end
     pointer is updated to point to the new segment, and the forward
     pointer of the previous segment also is updated to point to the
     first integer of the new segment's descriptor. The backward
     pointer of the new segment points to to point to the first
     integer of the previous segment's descriptor.

     The normal sequence of operations required to create a DLA 
     segment is as follows:

        Call <a href="dlaopn.html">DLAOPN</a> to create a new, empty DLA file.

        For each segment to be created,

           Call <a href="dlabns.html">DLABNS</a> to begin a segment.

           Use the DAS &quot;add&quot; and &quot;update&quot; routines to populate
           the segment with data.

           Call <b>DLAENS</b> to end the segment.

        Call <a href="dascls.html">DASCLS</a> to segregate and close the DLA file.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     1) Create a DLA file containing one segment; the segment
        contains character, double precision, and integer data.
        After writing and closing the file, open the file for
        read access; dump the data to standard output.

 
              PROGRAM EX1
              IMPLICIT NONE

              INCLUDE 'dla.inc'

        C
        C     Local parameters
        C
              CHARACTER*(*)         DLA
              PARAMETER           ( DLA    = 'test.dla' )

              INTEGER               IFNLEN
              PARAMETER           ( IFNLEN =  60 )

              INTEGER               LNSIZE
              PARAMETER           ( LNSIZE =  80 )

              INTEGER               MAXC
              PARAMETER           ( MAXC   =  5 )

              INTEGER               MAXD
              PARAMETER           ( MAXD   =  50 )

              INTEGER               MAXI
              PARAMETER           ( MAXI   =  100 )

        C
        C     Local variables
        C
              CHARACTER*(LNSIZE)    CVALS   ( MAXC )
              CHARACTER*(LNSIZE)    CVALS2  ( MAXC )
              CHARACTER*(IFNLEN)    IFNAME

              DOUBLE PRECISION      DVALS   ( MAXD )
              DOUBLE PRECISION      DVALS2  ( MAXD )

              INTEGER               BASE
              INTEGER               DESCR   ( DLADSZ )
              INTEGER               HANDLE
              INTEGER               I
              INTEGER               IVALS   ( MAXI )
              INTEGER               IVALS2  ( MAXI )
              INTEGER               J
              INTEGER               K
              INTEGER               N
              INTEGER               NCOMCH

              LOGICAL               FOUND

        C
        C     Set the internal file name.  Don't reserve characters in
        C     the DAS comment area.
        C
              IFNAME = 'Example DLA file for testing'
              NCOMCH = 0

        C
        C     Open a new DLA file.
        C
              CALL <a href="dlaopn.html">DLAOPN</a> ( DLA, 'DLA', IFNAME, NCOMCH, HANDLE )

        C
        C     Begin a new segment.
        C
              CALL <a href="dlabns.html">DLABNS</a> ( HANDLE )

        C
        C     Add character data to the segment.
        C
              DO I = 1, MAXC

                 DO J = 1, LNSIZE

                    K = MOD( J+I-1, 10 )

                    CALL <a href="intstr.html">INTSTR</a> ( K,  CVALS(I)(J:J) )

                 END DO

              END DO

              CALL <a href="dasadc.html">DASADC</a> ( HANDLE, MAXC*LNSIZE, 1, LNSIZE, CVALS )

        C
        C     Add integer and double precision data to the segment.
        C
              DO I = 1, MAXI
                 IVALS(I) = I
              END DO

              CALL <a href="dasadi.html">DASADI</a> ( HANDLE, MAXI, IVALS )

              DO I = 1, MAXD
                 DVALS(I) = I
              END DO

              CALL <a href="dasadd.html">DASADD</a> ( HANDLE, MAXD, DVALS )

        C
        C     End the segment.
        C
              CALL <b>DLAENS</b> ( HANDLE )

        C
        C     Close the file.  The routine <a href="dascls.html">DASCLS</a> flushes the DAS
        C     buffers and segregates the file before closing it.
        C
              CALL <a href="dascls.html">DASCLS</a> ( HANDLE )

        C
        C     Now read the file and check the data.
        C
              CALL DASOPR ( DLA, HANDLE )

        C
        C     Obtain the segment descriptor for the sole segment 
        C     in the file. We need not check the found flag 
        C     in this case because we know there is one segment
        C     in the file.
        C
              CALL <a href="dlabfs.html">DLABFS</a> ( HANDLE, DESCR, FOUND )

        C
        C     Fetch character data from the segment.  Obtain the 
        C     base address of the character data and the
        C     character count from the descriptor.
        C
              BASE = DESCR(CBSIDX)
              N    = DESCR(CSZIDX)

              CALL <a href="dasrdc.html">DASRDC</a> ( HANDLE, BASE+1, BASE+N, 1, LNSIZE, CVALS2 )

        C
        C     Display the character data.
        C
              WRITE (*,*) ' '
              WRITE (*,*) 'Character array'

              DO I = 1, N/LNSIZE
                 WRITE (*,*) CVALS2(I)
              END DO

        C
        C     Fetch and display the integer and double precision data.
        C
              BASE = DESCR(IBSIDX)
              N    = DESCR(ISZIDX)

              CALL <a href="dasrdi.html">DASRDI</a>( HANDLE, BASE+1, BASE+N, IVALS2 )

              WRITE (*,*) ' '
              WRITE (*,*) 'Integer array'
              WRITE (*,*) IVALS2


              BASE = DESCR(DBSIDX)
              N    = DESCR(DSZIDX)

              CALL <a href="dasrdd.html">DASRDD</a>( HANDLE, BASE+1, BASE+N, DVALS2 )

              WRITE (*,*) ' '
              WRITE (*,*) 'Double precision array'
              WRITE (*,*) DVALS2

        C
        C     Close the file.  This step is unnecessary in this 
        C     program, but is a good practice in general 
        C     because closing the file frees resources.
        C
              CALL <a href="dascls.html">DASCLS</a> ( HANDLE )

              END
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman    (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0, 08-FEB-2017 (NJB)

        Updated version info.

        08-OCT-2009 (NJB)

           Updated header.

        11-FEB-2005 (NJB)</PRE>
<h4>Link to routine DLAENS source file <a href='../../../src/spicelib/dlaens.f'>dlaens.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Wed Apr  5 17:46:24 2017</pre>

</body>
</html>

