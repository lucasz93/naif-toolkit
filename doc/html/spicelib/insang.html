
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>insang</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>insang</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 INSANG ( Inside Tetrahedral Angle )
 
      SUBROUTINE INSANG ( V, E1, E2, E3, FOUND, SCALE )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Determine if a given vector lies inside the solid tetrahedral
     angle determined by 3 vectors. If it does, return the
     point where the scale factor such that SCALE*V lies in the
     plane spanned by E1, E2, and E3.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
      None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
      VECTOR
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE
      DOUBLE PRECISION      V     ( 3 )
      DOUBLE PRECISION      E1    ( 3 )
      DOUBLE PRECISION      E2    ( 3 )
      DOUBLE PRECISION      E3    ( 3 )
      LOGICAL               FOUND
      DOUBLE PRECISION      SCALE
 
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     V          I   Vector to test for &quot;betweenness&quot;
     E1         I   First edge of the tetrahedral angle
     E2         I   Second edge of the tetrahedral angle
     E3         I   Third edge of the tetrahedral angle
     FOUND      O   Indicates whether V lies in the solid angle
     SCALE      O   Scale times V is in the triangle E1,E2,E3
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     V          is a 3-vector.  This is the vector to test to see
                if it lies between the 3 vectors E1, E2 and E3

     E1         are the three edges of a solid tetrahedral angle.
     E2         (See particulars for a discussion of the solid
     E3         angle).
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     FOUND      indicates that V lies inside the solid tetrahedral
                angle determined by E1, E2 and E3.


     SCALE      if V lies inside the solid tetrahedral angle given
                by E1, E2 and E3, SCALE*V is the point is the positive
                scalar multiple of V that pierces the triangle
                determined by the points E1, E2, E3.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.

     1) If E1, E2 and E3 are not linearly independent, the routine
        returns FALSE. SCALE will be set to 0.

     2) If V is the zero vector, the routine returns FALSE.
        SCALE will be set to 0.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Given 3 linearly independent vectors E1, E2, and E3 the
     set of vectors a*E1 + b*E2 + c*E3  where a, b, and c
     are non-negative form a region of space that is a tetrahedral
     solid angle.  If you cut this solid angle with a plane
     that intersects all three rays from the origin determined
     by E1, E2 and E3 you will get a tetrahedron (a 4-sided
     solid with each face a triangle).

     This routine determines whether the ray associated with
     a vector V lies inside the tetrahedral angle E1,E2,E3.
     Moreover, if V lies inside this angle, this routine returns
     the scale factor SCALE such that the point SCALE*V
     lies in the plane containing the points E1, E2 and E3.
     This is necessarily a point in the triangle determined by
     E1, E2 and E3.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     Suppose you have a triangle in space specified by three
     vertices P1, P2 and P3 and that an observer at location
     OBS is looking along the ray emanating from OBS with
     direction V.  Does this ray intersect the triangle
     P1, P2, P3?  Using this routine, you can answer this
     question and give the point of intersection if there is
     one.  Here's how.

     First construct the vectors from OBS to the corners of
     the triangle.

     CALL <a href="vsub.html">VSUB</a> ( P1, OBS, E1 )
     CALL <a href="vsub.html">VSUB</a> ( P2, OBS, E2 )
     CALL <a href="vsub.html">VSUB</a> ( P3, OBS, E3 )

     Now see if V lies between the vectors E1, E2, E3 and return
     the intersection point if it does.

     CALL <b>INSANG</b> ( V, E1, E2, E3, FOUND, SCALE )

     If there was an intersection, add SCALE*V to OBS to get the
     point of intersection.  Otherwise say there was no intersection.

     IF ( FOUND ) THEN

        CALL <a href="vlcom.html">VLCOM</a> ( 1.0D0, OBS, SCALE, V, POINT )

        WRITE (*,*) 'The ray intersects the triangle at:
        WRITE (*,*) POINT(1)
        WRITE (*,*) POINT(2)
        WRITE (*,*) POINT(3)

     ELSE

        WRITE (*,*) 'There is no intersection.'

     END IF
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     This routine can suffer from extreme loss of precision if
     the vectors E1, E2, E3 are too long compared to the lengths
     of the line segments formed by their pairwise differences.
     
     The user of this routine must ensure that the inputs are 
     suitable.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman    (JPL)
     W.L. Taber      (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.2, 02-FEB-2016 (NJB)

        Fixed comment typos. Updated Restrictions.

    SPICELIB Version 1.0.1, 08-OCT-2009 (NJB)

        Updated header.

    SPICELIB Version 1.0.0, 09-JUN-1996 (WLT)</PRE>
<h4>Link to routine INSANG source file <a href='../../../src/spicelib/insang.f'>insang.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Wed Apr  5 17:46:45 2017</pre>

</body>
</html>

