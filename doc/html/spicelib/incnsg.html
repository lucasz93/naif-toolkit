
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>incnsg</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>incnsg</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      INCNSG ( Intersection of cone and line segment )
 
      SUBROUTINE INCNSG ( APEX,   AXIS,  ANGLE, ENDPT1, 
     .                    ENDPT2, NXPTS, XPT1,  XPT2   )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Compute the points of intersection of a specified nappe of a cone
     and a line segment.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     CONE
     GEOMETRY
     INTERSECTION
     LINE
     MATH
     SEGMENT
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE

      DOUBLE PRECISION      APEX   ( 3 )
      DOUBLE PRECISION      AXIS   ( 3 )
      DOUBLE PRECISION      ANGLE
      DOUBLE PRECISION      ENDPT1 ( 3 )
      DOUBLE PRECISION      ENDPT2 ( 3 )
      INTEGER               NXPTS
      DOUBLE PRECISION      XPT1   ( 3 )
      DOUBLE PRECISION      XPT2   ( 3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     APEX       I   Apex of cone.
     AXIS       I   Axis of cone.
     ANGLE      I   Angle of cone.
     ENDPT1,
     ENDPT2     I   Endpoints of line segment.
     NXPTS      O   Number of intersection points.
     XPT1       O   First intersection point, if it exists.
     XPT2       O   Second intersection point, if it exists.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     APEX       is the apex (tip) of the cone. In this routine's
                documentation, we'll consider the cone to be a
                semi-infinite pyramid with circular cross-section. In
                some contexts, this object is called one &quot;nappe&quot; of
                the complete cone.

     AXIS       is an axis vector of the cone.                  

     ANGLE      is the angular separation from AXIS of the rays
                comprising the cone. Let the notation

                   &lt; A, B &gt;
 
                denote the dot product of vectors A and B, and let

                   ||A||

                denote the norm of vector A. Then the cone is the set
                of points

                             X-APEX       AXIS
                   { X:  &lt; ----------,  -------- &gt;  =  cos(ANGLE) }
                           ||X-APEX||   ||AXIS||


     ENDPT1,
     ENDPT2     are endpoints of a line segment. These points 
                must be distinct.
          
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     NXPTS      is the number of points of intersection of the input
                line segment and cone.

     XPT1       is the point of intersection of the segment and cone
                that is closest to ENDPT1, if an intersection exists.
                If there are no intersections, XPT1 is undefined.

     XPT2       is the point of intersection of the segment and cone
                that is farthest from ENDPT1, if two points of
                intersection exist. If there are not two
                intersections, XPT2 is undefined.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If AXIS is the zero vector, the error SPICE(ZEROVECTOR)
         will be signaled.

     2)  If ANGLE is less than zero, the error SPICE(INVALIDANGLE)
         will be signaled.

     3)  If ENDPT1 and ENDPT2 coincide, the error
         SPICE(ENDPOINTSMATCH) will be signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine is used by the SPICELIB DSK subsystem. In
     particular, it is used to determine whether a ray contacts a
     latitude boundary of a volume element in either planetocentric
     latitudinal or planetodetic coordinates.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as input
     (if any), the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Compute the intersection of a line segment and cone in
        a simple case for which the results can easily be checked.
     
        Let the apex of the cone be at the origin. Let the axis
        of the cone lie on the +X axis. Let the angle of the cone
        be 45 degrees. Let the line segment have endpoints 

           ENDPT1 = ( 1,   -2, sqrt(3)/2 )
           ENDPT2 = ( 1,    2, sqrt(3)/2 )
     
        We expect there to be two points of intersection:
      
           XPT1   = ( 1, -1/2, sqrt(3)/2 )
           XPT2   = ( 1,  1/2, sqrt(3)/2 )


        Example code begins here. 
 

              PROGRAM EX1
              IMPLICIT NONE
        C
        C     SPICELIB functions
        C
              DOUBLE PRECISION      <a href="rpd.html">RPD</a>
        C
        C     Local parameters
        C
              CHARACTER*(*)         FMT1
              PARAMETER           ( FMT1 = '(A,3F13.8)' )

              CHARACTER*(*)         FMT2
              PARAMETER           ( FMT2 = '(A,I2)' )
        C
        C     Local variables
        C
              DOUBLE PRECISION      ANGLE
              DOUBLE PRECISION      APEX   ( 3 )
              DOUBLE PRECISION      AXIS   ( 3 )
              DOUBLE PRECISION      ENDPT1 ( 3 )
              DOUBLE PRECISION      ENDPT2 ( 3 )
              DOUBLE PRECISION      SQ3
              DOUBLE PRECISION      XPT1   ( 3 )
              DOUBLE PRECISION      XPT2   ( 3 )

              INTEGER               NXPTS

        C
        C     Set up the cone's geometric attributes.
        C
              CALL <a href="vpack.html">VPACK</a> ( 0.D0, 0.D0, 0.D0, APEX )
              CALL <a href="vpack.html">VPACK</a> ( 1.D0, 0.D0, 0.D0, AXIS )

              ANGLE = 45.D0 * <a href="rpd.html">RPD</a>()
        C
        C     Initialize the line segment's endpoints.
        C
              SQ3 = SQRT( 3.D0  )

              CALL <a href="vpack.html">VPACK</a> ( 1.D0, -2.D0, SQ3/2, ENDPT1 )
              CALL <a href="vpack.html">VPACK</a> ( 1.D0,  2.D0, SQ3/2, ENDPT2 )
        C
        C     Find the points of intersection.
        C
              CALL <b>INCNSG</b> ( APEX,   AXIS,  ANGLE, ENDPT1,
             .              ENDPT2, NXPTS, XPT1,  XPT2   )

              WRITE (*,*) ' '
              WRITE (*,FMT1) 'Apex:        ', APEX
              WRITE (*,FMT1) 'Axis:        ', AXIS
              WRITE (*,FMT1) 'Angle (deg): ', ANGLE/<a href="rpd.html">RPD</a>()
              WRITE (*,FMT1) 'Endpoint 1:  ', ENDPT1
              WRITE (*,FMT1) 'Endpoint 2:  ', ENDPT2
              WRITE (*,*) ' '
              WRITE (*,FMT2) 'Number of intersection points: ',
             .            NXPTS
              WRITE (*,*) ' '
              WRITE (*,FMT1) 'Point 1:    ', XPT1
              WRITE (*,FMT1) 'Point 2:    ', XPT2
              WRITE (*,*) ' '

              END

    
     When this program was executed on a PC/Linux/gfortran/64-bit
     platform, the output was:


        Apex:           0.00000000   0.00000000   0.00000000
        Axis:           1.00000000   0.00000000   0.00000000
        Angle (deg):   45.00000000
        Endpoint 1:     1.00000000  -2.00000000   0.86602540
        Endpoint 2:     1.00000000   2.00000000   0.86602540

        Number of intersection points:  2

        Point 1:       1.00000000  -0.50000000   0.86602540
        Point 2:       1.00000000   0.50000000   0.86602540
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     1)  This routine is designed to avoid arithmetic overflow in
         normal cases, such as those in which the line segment is
         nearly parallel to the cone. However, it is possible to cause
         arithmetic overflow by using input vectors with extremely
         large magnitudes.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0 26-OCT-2016 (NJB)</PRE>
<h4>Link to routine INCNSG source file <a href='../../../src/spicelib/incnsg.f'>incnsg.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Wed Apr  5 17:46:44 2017</pre>

</body>
</html>

