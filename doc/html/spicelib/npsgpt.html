
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>npsgpt</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>npsgpt</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
      NPSGPT ( Nearest point on line segment )
 
      SUBROUTINE NPSGPT ( EP1, EP2, POINT, PNEAR, DIST )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Find the nearest point on a line segment to a given point.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     GEOMETRY
     MATH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE

      DOUBLE PRECISION      EP1   ( 3 )
      DOUBLE PRECISION      EP2   ( 3 )
      DOUBLE PRECISION      POINT ( 3 )
      DOUBLE PRECISION      PNEAR ( 3 )
      DOUBLE PRECISION      DIST

 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     Variable  I/O  Description
     --------  ---  --------------------------------------------------
     EP1,
     EP2        I   Endpoints of a line segment.
     POINT      I   A point in 3-dimensional space.
     PNEAR      O   Nearest point on the line segment to POINT.
     DIST       O   Distance between PNEAR and POINT.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     EP1,
     EP2        are the endpoints of a line segment in 3-dimensional 
                space. EP1 and EP2 need not be distinct.

     POINT      is an arbitrary point in 3-dimensional space.
          
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     PNEAR      is the closest point on the line segment to POINT.

     DIST       is the distance between POINT and PNEAR.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1) The input segment is allowed to be degenerate: it may be
        a single point.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as input
     (if any), the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Compute the nearest point on a line segment to a given
        point in a simple case for which the results can easily be
        checked.


        Example code begins here. 

 
              PROGRAM EX1
              IMPLICIT NONE
        C
        C     Local parameters
        C
              CHARACTER*(*)         FMT1
              PARAMETER           ( FMT1 = '(A,3F13.8)' )
        C
        C     Local variables
        C
              DOUBLE PRECISION      DIST
              DOUBLE PRECISION      ENDPT1 ( 3 )
              DOUBLE PRECISION      ENDPT2 ( 3 )
              DOUBLE PRECISION      PNEAR  ( 3 )
              DOUBLE PRECISION      POINT  ( 3 )

        C
        C     Initialize the line segment's endpoints.
        C
              CALL <a href="vpack.html">VPACK</a> ( 1.D0, -2.D0, 3.D0, ENDPT1 )
              CALL <a href="vpack.html">VPACK</a> ( 1.D0,  2.D0, 3.D0, ENDPT2 )
        C
        C     Set the input point.
        C
              CALL <a href="vpack.html">VPACK</a> ( 1.D0,  0.D0, 0.D0, POINT )
        C
        C     Find the near point on the segment.
        C
              CALL <b>NPSGPT</b> ( ENDPT1, ENDPT2, POINT, PNEAR, DIST )

              WRITE (*,*) ' '
              WRITE (*,FMT1) 'Endpoint 1:  ', ENDPT1
              WRITE (*,FMT1) 'Endpoint 2:  ', ENDPT2
              WRITE (*,FMT1) 'Point:       ', POINT
              WRITE (*,*) ' '
              WRITE (*,FMT1) 'Near point:  ', PNEAR
              WRITE (*,FMT1) 'Distance:    ', DIST
              WRITE (*,*) ' '

              END


     When this program was executed on a PC/Linux/gfortran/64-bit
     platform, the output was:


        Endpoint 1:     1.00000000  -2.00000000   3.00000000
        Endpoint 2:     1.00000000   2.00000000   3.00000000
        Point:          1.00000000   0.00000000   0.00000000

        Near point:     1.00000000   0.00000000   3.00000000
        Distance:       3.00000000
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman   (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0, 02-FEB-MAR-2016 (NJB)

        Updated from DSKLIB Version 1.0.0, 20-MAR-2015 (NJB)</PRE>
<h4>Link to routine NPSGPT source file <a href='../../../src/spicelib/npsgpt.f'>npsgpt.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Wed Apr  5 17:46:58 2017</pre>

</body>
</html>

