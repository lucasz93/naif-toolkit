
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>ednmpt</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>ednmpt</b> </td>
    </tr>

    <tr>
      <td style="vertical-align: top;">

<small><div align="center">
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div></small>
       <br>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
            <small>
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </small>
              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">
              <small>               <a href="#Examples">Examples<br></a>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
             </small>
            </td>
          </tr>
        </tbody>
</table>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
 EDNMPT ( Ellipsoid normal vector to surface point )
 
      SUBROUTINE EDNMPT ( A, B, C, NORMAL, POINT )
 
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Return the unique point on an ellipsoid's surface where the
     outward normal direction is a given vector.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ELLIPSOID
     GEOMETRY
     NORMAL
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
 
      IMPLICIT NONE

      DOUBLE PRECISION      A
      DOUBLE PRECISION      B
      DOUBLE PRECISION      C
      DOUBLE PRECISION      NORMAL ( 3 )
      DOUBLE PRECISION      POINT  ( 3 )
 
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     A          I   Length of the ellipsoid semi-axis along the x-axis.
     B          I   Length of the ellipsoid semi-axis along the y-axis.
     C          I   Length of the ellipsoid semi-axis along the z-axis.
     NORMAL     I   Outward normal direction.
     POINT      O   Point where outward normal is parallel to NORMAL.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     A          is the length of the semi-axis of the ellipsoid
                that is parallel to the x-axis of the body-fixed
                coordinate system.

     B          is the length of the semi-axis of the ellipsoid
                that is parallel to the y-axis of the body-fixed
                coordinate system.

     C          is the length of the semi-axis of the ellipsoid
                that is parallel to the z-axis of the body-fixed
                coordinate system.

     NORMAL     is a non-zero vector. The unique point on the
                ellipsoid at which NORMAL is an outward normal vector
                is sought.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     POINT      is the unique point on the ellipsoid at which NORMAL
                is an outward normal vector.

                POINT is a 3-vector giving the bodyfixed coordinates
                of a point on the ellipsoid. In bodyfixed coordinates,
                the semi-axes of the ellipsoid are aligned with the x,
                y, and z-axes of the coordinate system.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If any of the semi-axis lengths is non-positive, the error
         SPICE(BADAXISLENGTH) will be signaled.

     2)  If any of the semi-axis lengths underflows to zero when
         divided by the largest semi-axis length, the error
         SPICE(AXISUNDERFLOW) will be signaled.

     3)  If NORMAL is the zero vector, the error SPICE(ZEROVECTOR)
         will be signaled.

     4)  If the input pass the above checks but lead to a 
         divide-by-zero error or to an computing an invalid argument
         of a fractional exponential expression, the error
         SPICE(DEGENERATECASE) will be signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine can be used to determine the distance between an
     ellipsoid and a non-intersecting plane. This distance computation
     supports computation of terminator points on an ellipsoid.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine 
     specific arithmetic implementation. 

     1) Choose a triaxial ellipsoid with three unequal semi-axis
        lengths. Pick several vectors; find the points on the
        ellipsoid where the respective outward normals are parallel to
        those vectors. 

        Check the results: at each point, a computed outward normal
        vector should have very small angular separation from the
        input vector. Also, the point should be on the surface of the
        ellipsoid. The ellipsoid can be thought of as a level surface
        of the function

                             2        2         2
           f(x, y, z) = (x/a)  + (y/b)  +  (z/c)

        where a, b, c are the semi-axis lengths of the ellipsoid.
        Specifically, the ellipsoid is the set

           { (x, y, z) : f(x, y, z)  =  1 }

        We can evaluate f at a point to determine whether that point
        is close to the ellipsoid's surface.


        Example code begins here.
 

              PROGRAM EX1
              IMPLICIT NONE
        C
        C     SPICELIB functions
        C
              DOUBLE PRECISION      <a href="vsep.html">VSEP</a>
        C
        C     Local parameters
        C
              CHARACTER*(*)         FMT1
              PARAMETER           ( FMT1 = '(A,3F15.9)' )
        C
        C     Local variables
        C
              DOUBLE PRECISION      A
              DOUBLE PRECISION      B
              DOUBLE PRECISION      C
              DOUBLE PRECISION      NORMAL ( 3 )
              DOUBLE PRECISION      POINT  ( 3 )
              DOUBLE PRECISION      XNORML ( 3 )
        C
        C     Initialize the ellipsoid semi-axes.
        C
              A = 10.D0
              B =  5.D0
              C =  2.D0
        C
        C     Pick several vectors; find the points
        C     on the ellipsoid where the respective
        C     outward normals are parallel to those
        C     vectors; check the results.
        C
              CALL <a href="vpack.html">VPACK</a>  ( 0.D0, 0.D0, 3.D0, XNORML )
              CALL <b>EDNMPT</b> ( A,    B,    C,    XNORML, POINT  )
              CALL <a href="surfnm.html">SURFNM</a> ( A,    B,    C,    POINT,  NORMAL )

              WRITE (*,*   ) ' '
              WRITE (*,FMT1) 'Semi-axis lengths:   ', A, B, C
              WRITE (*,FMT1) 'Input vector:        ', XNORML
              WRITE (*,FMT1) 'Point:               ', POINT
              WRITE (*,FMT1) 'Outward normal:      ', NORMAL
              WRITE (*,FMT1) 'Angular error (rad): ', <a href="vsep.html">VSEP</a>(NORMAL,
             .                                          XNORML )
              WRITE (*,FMT1) 'Off-surface error:   ',
             .                 (POINT(1)/A)**2 + (POINT(2)/B)**2
             .               + (POINT(3)/C)**2 - 1
              WRITE (*,*) ' '


              CALL <a href="vpack.html">VPACK</a>  ( 15.D0, -7.D0, 3.D0, XNORML )
              CALL <b>EDNMPT</b> ( A,      B,    C,    XNORML, POINT  )
              CALL <a href="surfnm.html">SURFNM</a> ( A,      B,    C,    POINT,  NORMAL )

              WRITE (*,FMT1) 'Semi-axis lengths:   ', A, B, C
              WRITE (*,FMT1) 'Input vector:        ', XNORML
              WRITE (*,FMT1) 'Point:               ', POINT
              WRITE (*,FMT1) 'Outward normal:      ', NORMAL
              WRITE (*,FMT1) 'Angular error (rad): ', <a href="vsep.html">VSEP</a>(NORMAL,
             .                                             XNORML )
              WRITE (*,FMT1) 'Off-surface error:   ',
             .                 (POINT(1)/A)**2 + (POINT(2)/B)**2
             .               + (POINT(3)/C)**2 - 1
              WRITE (*,*) ' '

              CALL <a href="vpack.html">VPACK</a>  ( 15.D0, -7.D0, 3.D0, XNORML )
              CALL <b>EDNMPT</b> ( A,      B,    C,    XNORML, POINT  )
              CALL <a href="surfnm.html">SURFNM</a> ( A,      B,    C,    POINT,  NORMAL )

              WRITE (*,FMT1) 'Semi-axis lengths:   ', A, B, C
              WRITE (*,FMT1) 'Input vector:        ', XNORML
              WRITE (*,FMT1) 'Point:               ', POINT
              WRITE (*,FMT1) 'Outward normal:      ', NORMAL
              WRITE (*,FMT1) 'Angular error (rad): ', <a href="vsep.html">VSEP</a>(NORMAL,
             .                                             XNORML )
              WRITE (*,FMT1) 'Off-surface error:   ',
             .                 (POINT(1)/A)**2 + (POINT(2)/B)**2
             .               + (POINT(3)/C)**2 - 1
              WRITE (*,*) ' '

              CALL <a href="vpack.html">VPACK</a>  ( A/2, B/2,  C/2, XNORML )
              CALL <b>EDNMPT</b> ( A,   B,    C,   XNORML, POINT  )
              CALL <a href="surfnm.html">SURFNM</a> ( A,   B,    C,   POINT,  NORMAL )

              WRITE (*,FMT1) 'Semi-axis lengths:   ', A, B, C
              WRITE (*,FMT1) 'Input vector:        ', XNORML
              WRITE (*,FMT1) 'Point:               ', POINT
              WRITE (*,FMT1) 'Outward normal:      ', NORMAL
              WRITE (*,FMT1) 'Angular error (rad): ', <a href="vsep.html">VSEP</a>(NORMAL,
             .                                             XNORML )
              WRITE (*,FMT1) 'Off-surface error:   ',
             .                 (POINT(1)/A)**2 + (POINT(2)/B)**2
             .               + (POINT(3)/C)**2 - 1
              WRITE (*,*) ' '
              END


     When this program was executed on a PC/Linux/gfortran 64-bit 
     platform, the output was:
 

     Semi-axis lengths:      10.000000000    5.000000000    2.000000000
     Input vector:            0.000000000    0.000000000    3.000000000
     Point:                   0.000000000    0.000000000    2.000000000
     Outward normal:          0.000000000    0.000000000    1.000000000
     Angular error (rad):     0.000000000
     Off-surface error:       0.000000000

     Semi-axis lengths:      10.000000000    5.000000000    2.000000000
     Input vector:           15.000000000   -7.000000000    3.000000000
     Point:                   9.731032027   -1.135287070    0.077848256
     Outward normal:          0.891657447   -0.416106809    0.178331489
     Angular error (rad):     0.000000000
     Off-surface error:       0.000000000

     Semi-axis lengths:      10.000000000    5.000000000    2.000000000
     Input vector:           15.000000000   -7.000000000    3.000000000
     Point:                   9.731032027   -1.135287070    0.077848256
     Outward normal:          0.891657447   -0.416106809    0.178331489
     Angular error (rad):     0.000000000
     Off-surface error:       0.000000000

     Semi-axis lengths:      10.000000000    5.000000000    2.000000000
     Input vector:            5.000000000    2.500000000    1.000000000
     Point:                   9.694128639    1.211766080    0.077553029
     Outward normal:          0.880450906    0.440225453    0.176090181
     Angular error (rad):     0.000000000
     Off-surface error:       0.000000000
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman    (JPL)
     W.L. Taber      (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.0.0, 17-MAY-2016 (NJB) (WLT)</PRE>
<h4>Link to routine EDNMPT source file <a href='../../../src/spicelib/ednmpt.f'>ednmpt.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Wed Apr  5 17:46:29 2017</pre>

</body>
</html>

